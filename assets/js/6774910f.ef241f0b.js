"use strict";(self.webpackChunkschool_learn=self.webpackChunkschool_learn||[]).push([[5400],{4072:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>d,toc:()=>c});var t=n(7624),i=n(2172);const r={id:"methodes-validation",title:"M\xe9thodes de validation",sidebar_position:8},l="M\xe9thodes de validation",d={id:"ai-python/course/methodes-validation",title:"M\xe9thodes de validation",description:"Lorsque l\u2019on entra\xeene un mod\xe8le, on veut savoir s\u2019il sera bon sur des donn\xe9es qu\u2019il ne conna\xeet pas.",source:"@site/docs/ai-python/course/08-01-model-k-cross.md",sourceDirName:"ai-python/course",slug:"/ai-python/course/methodes-validation",permalink:"/documentation/docs/ai-python/course/methodes-validation",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/ai-python/course/08-01-model-k-cross.md",tags:[],version:"current",sidebarPosition:8,frontMatter:{id:"methodes-validation",title:"M\xe9thodes de validation",sidebar_position:8},sidebar:"tutorialSidebar",previous:{title:"\xc9valuation Mod\xe8les",permalink:"/documentation/docs/ai-python/course/eval-model"},next:{title:"Les modeles dans Scikit-learn",permalink:"/documentation/docs/ai-python/course/model-scikit-learn"}},o={},c=[{value:"1. Validation non-crois\xe9e (Holdout Method)",id:"1-validation-non-crois\xe9e-holdout-method",level:2},{value:"Description",id:"description",level:3},{value:"Exemple concret",id:"exemple-concret",level:3},{value:"2. Validation crois\xe9e \xab seul contre tous \xbb (Leave-One-Out)",id:"2-validation-crois\xe9e--seul-contre-tous--leave-one-out",level:2},{value:"Description",id:"description-1",level:3},{value:"Exemple concret",id:"exemple-concret-1",level:3},{value:"3. Validation crois\xe9e \xe0 k blocs (K-Fold Cross Validation)",id:"3-validation-crois\xe9e-\xe0-k-blocs-k-fold-cross-validation",level:2},{value:"Description",id:"description-2",level:3},{value:"Comparatif des m\xe9thodes",id:"comparatif-des-m\xe9thodes",level:4},{value:"Comment distinguer Leave-One-Out et K-Fold simplement ?",id:"comment-distinguer-leave-one-out-et-k-fold-simplement-",level:3},{value:"Leave-One-Out",id:"leave-one-out",level:4},{value:"K-Fold",id:"k-fold",level:4},{value:"Tableau comparatif",id:"tableau-comparatif",level:4},{value:"Tableau encore plus simple",id:"tableau-encore-plus-simple",level:4},{value:"K-FOLD plus d\xe9taill\xe9",id:"k-fold-plus-d\xe9taill\xe9",level:4}];function a(e){const s={br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.M)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.h1,{id:"m\xe9thodes-de-validation",children:"M\xe9thodes de validation"}),"\n",(0,t.jsxs)(s.p,{children:["Lorsque l\u2019on entra\xeene un mod\xe8le, on veut savoir ",(0,t.jsx)(s.strong,{children:"s\u2019il sera bon sur des donn\xe9es qu\u2019il ne conna\xeet pas"}),".",(0,t.jsx)(s.br,{}),"\n","C\u2019est pourquoi on utilise des techniques de ",(0,t.jsx)(s.strong,{children:"validation"}),", qui consistent \xe0 s\xe9parer les donn\xe9es en parties pour entra\xeener et tester."]}),"\n",(0,t.jsx)(s.p,{children:"Voici les trois approches les plus courantes :"}),"\n",(0,t.jsx)(s.h2,{id:"1-validation-non-crois\xe9e-holdout-method",children:"1. Validation non-crois\xe9e (Holdout Method)"}),"\n",(0,t.jsx)(s.h3,{id:"description",children:"Description"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["On divise le jeu de donn\xe9es en ",(0,t.jsx)(s.strong,{children:"deux parties"})," : entra\xeenement et test"]}),"\n",(0,t.jsxs)(s.li,{children:["On ",(0,t.jsx)(s.strong,{children:"entra\xeene sur une partie"}),", on ",(0,t.jsx)(s.strong,{children:"teste sur l\u2019autre"})]}),"\n",(0,t.jsx)(s.li,{children:"C\u2019est la m\xe9thode la plus simple"}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'from sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LogisticRegression\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3)\n\nmodel = LogisticRegression()\nmodel.fit(X_train, y_train)\n\nscore = model.score(X_test, y_test)\nprint(f"Score : {score}")\n'})}),"\n",(0,t.jsx)(s.h3,{id:"exemple-concret",children:"Exemple concret"}),"\n",(0,t.jsxs)(s.p,{children:["Tu donnes 70 fiches d\u2019exercices \xe0 un \xe9l\xe8ve pour s\u2019entra\xeener, et tu en gardes 30 pour l\u2019interroger.",(0,t.jsx)(s.br,{}),"\n","Mais selon les fiches choisies, le test peut \xeatre trop facile ou trop difficile."]}),"\n",(0,t.jsx)(s.h2,{id:"2-validation-crois\xe9e--seul-contre-tous--leave-one-out",children:"2. Validation crois\xe9e \xab seul contre tous \xbb (Leave-One-Out)"}),"\n",(0,t.jsx)(s.h3,{id:"description-1",children:"Description"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Chaque observation est utilis\xe9e ",(0,t.jsx)(s.strong,{children:"seule pour le test"}),", toutes les autres pour l\u2019entra\xeenement"]}),"\n",(0,t.jsxs)(s.li,{children:["On r\xe9p\xe8te \xe7a ",(0,t.jsx)(s.strong,{children:"autant de fois qu\u2019il y a de donn\xe9es"})]}),"\n",(0,t.jsx)(s.li,{children:"Tr\xe8s pr\xe9cis mais tr\xe8s lent sur de grands jeux de donn\xe9es"}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'from sklearn.model_selection import LeaveOneOut\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.model_selection import cross_val_score\n\nloo = LeaveOneOut()\nmodel = LogisticRegression()\n\nscores = cross_val_score(model, X, y, cv=loo)\nprint(f"Score moyen : {scores.mean()}")\n'})}),"\n",(0,t.jsx)(s.h3,{id:"exemple-concret-1",children:"Exemple concret"}),"\n",(0,t.jsxs)(s.p,{children:["Tu interroges un \xe9l\xe8ve ",(0,t.jsx)(s.strong,{children:"sur une seule fiche"}),", et tu recommences avec toutes les autres fiches une \xe0 une.",(0,t.jsx)(s.br,{}),"\n","Tu obtiens un score moyen tr\xe8s pr\xe9cis."]}),"\n",(0,t.jsx)(s.h2,{id:"3-validation-crois\xe9e-\xe0-k-blocs-k-fold-cross-validation",children:"3. Validation crois\xe9e \xe0 k blocs (K-Fold Cross Validation)"}),"\n",(0,t.jsx)(s.h3,{id:"description-2",children:"Description"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Le jeu de donn\xe9es est divis\xe9 en ",(0,t.jsx)(s.strong,{children:"k blocs (folds)"})]}),"\n",(0,t.jsx)(s.li,{children:"\xc0 chaque tour, 1 bloc sert au test, les autres \xe0 l\u2019entra\xeenement"}),"\n",(0,t.jsxs)(s.li,{children:["On r\xe9p\xe8te ",(0,t.jsx)(s.strong,{children:"k fois"}),", chaque bloc est test\xe9 une fois"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'from sklearn.model_selection import cross_val_score\nfrom sklearn.linear_model import LogisticRegression\n\nmodel = LogisticRegression()\nscores = cross_val_score(model, X, y, cv=5)  # ici k=5\n\nprint(f"Scores par fold : {scores}")\nprint(f"Score moyen : {scores.mean()}")\n'})}),"\n",(0,t.jsx)(s.h4,{id:"comparatif-des-m\xe9thodes",children:"Comparatif des m\xe9thodes"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"M\xe9thode"}),(0,t.jsx)(s.th,{children:"Nombre de tests"}),(0,t.jsx)(s.th,{children:"Pr\xe9cision"}),(0,t.jsx)(s.th,{children:"Vitesse"}),(0,t.jsx)(s.th,{children:"Recommand\xe9e pour"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Holdout"}),(0,t.jsx)(s.td,{children:"1"}),(0,t.jsx)(s.td,{children:"Faible \xe0 moyenne"}),(0,t.jsx)(s.td,{children:"Rapide"}),(0,t.jsx)(s.td,{children:"D\xe9monstration, cas simples"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Leave-One-Out"}),(0,t.jsx)(s.td,{children:"n"}),(0,t.jsx)(s.td,{children:"Tr\xe8s \xe9lev\xe9e"}),(0,t.jsx)(s.td,{children:"Tr\xe8s lent (si n grand)"}),(0,t.jsx)(s.td,{children:"Petits jeux de donn\xe9es, cas critiques"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"K-Fold (ex: K=5 ou 10)"}),(0,t.jsx)(s.td,{children:"K"}),(0,t.jsx)(s.td,{children:"\xc9lev\xe9e et stable"}),(0,t.jsx)(s.td,{children:"Moyennement rapide"}),(0,t.jsx)(s.td,{children:"Pratique courante"})]})]})]}),"\n",(0,t.jsx)(s.h3,{id:"comment-distinguer-leave-one-out-et-k-fold-simplement-",children:"Comment distinguer Leave-One-Out et K-Fold simplement ?"}),"\n",(0,t.jsx)(s.p,{children:"Imagine que tu as 100 fiches d'exercices pour entra\xeener un \xe9l\xe8ve. Tu veux savoir s\u2019il a bien compris la le\xe7on."}),"\n",(0,t.jsx)(s.h4,{id:"leave-one-out",children:"Leave-One-Out"}),"\n",(0,t.jsx)(s.p,{children:"Tu fais autant de tests qu\u2019il y a d\u2019exemples (par exemple 100 si tu as 100 donn\xe9es).\n\xc0 chaque test, tu gardes 1 seul exemple pour tester, et tu utilises tous les autres pour entra\xeener."}),"\n",(0,t.jsx)(s.p,{children:"C\u2019est une m\xe9thode tr\xe8s pr\xe9cise, car chaque donn\xe9e est test\xe9e individuellement.\nMais elle est aussi tr\xe8s lente si tu as beaucoup de donn\xe9es, et pas toujours bien \xe9quilibr\xe9e si certaines classes sont rares."}),"\n",(0,t.jsx)(s.h4,{id:"k-fold",children:"K-Fold"}),"\n",(0,t.jsx)(s.p,{children:"Tu fais 5 tests : chaque fois, un groupe diff\xe9rent est utilis\xe9 pour interroger, les autres pour s\u2019entra\xeener."}),"\n",(0,t.jsx)(s.p,{children:"C\u2019est plus \xe9quilibr\xe9 et plus fiable qu\u2019un seul test."}),"\n",(0,t.jsx)(s.h4,{id:"tableau-comparatif",children:"Tableau comparatif"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Crit\xe8re"}),(0,t.jsx)(s.th,{children:"Leave-One-Out"}),(0,t.jsx)(s.th,{children:"K-Fold (ex: K=5)"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Nombre de tests"}),(0,t.jsx)(s.td,{children:"1 par fiche (ex : 100 tests)"}),(0,t.jsx)(s.td,{children:"1 par groupe (ex : 5 tests)"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Taille du test"}),(0,t.jsx)(s.td,{children:"1 seule donn\xe9e"}),(0,t.jsx)(s.td,{children:"1 bloc (ex : 20 donn\xe9es)"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Vitesse"}),(0,t.jsx)(s.td,{children:"Tr\xe8s lent (si beaucoup de donn\xe9es)"}),(0,t.jsx)(s.td,{children:"Moyen (d\xe9pend de K)"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Pr\xe9cision"}),(0,t.jsx)(s.td,{children:"Tr\xe8s haute (chaque point test\xe9 seul)"}),(0,t.jsx)(s.td,{children:"Haute et \xe9quilibr\xe9e"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Quand l\u2019utiliser"}),(0,t.jsx)(s.td,{children:"Petits jeux de donn\xe9es"}),(0,t.jsx)(s.td,{children:"Cas pratiques courants"})]})]})]}),"\n",(0,t.jsx)(s.h4,{id:"tableau-encore-plus-simple",children:"Tableau encore plus simple"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"M\xe9thode"}),(0,t.jsx)(s.th,{children:"Comment \xe7a marche simplement ?"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Leave-One-Out"}),(0,t.jsxs)(s.td,{children:["Tu testes ",(0,t.jsx)(s.strong,{children:"1 fiche \xe0 la fois"}),", et tu recommences"]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"K-Fold"}),(0,t.jsxs)(s.td,{children:["Tu testes ",(0,t.jsx)(s.strong,{children:"des petits groupes de fiches"})," \xe0 chaque fois"]})]})]})]}),"\n",(0,t.jsx)(s.h4,{id:"k-fold-plus-d\xe9taill\xe9",children:"K-FOLD plus d\xe9taill\xe9"}),"\n",(0,t.jsx)(s.p,{children:"Exemple clair avec 10 donn\xe9es et K=5"}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.code,{children:"D1, D2, D3, D4, D5, D6, D7, D8, D9, D10"})}),"\n",(0,t.jsx)(s.p,{children:"Tu choisis K = 5, donc tu coupes en 5 groupes de 2 donn\xe9es :"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Fold"}),(0,t.jsx)(s.th,{children:"Donn\xe9es"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"1"}),(0,t.jsx)(s.td,{children:"D1, D2"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"2"}),(0,t.jsx)(s.td,{children:"D3, D4"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"3"}),(0,t.jsx)(s.td,{children:"D5, D6"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"4"}),(0,t.jsx)(s.td,{children:"D7, D8"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"5"}),(0,t.jsx)(s.td,{children:"D9, D10"})]})]})]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Ce qui se passe"})}),"\n",(0,t.jsx)(s.p,{children:"Tu fais 5 tours (K=5) :"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Tour"}),(0,t.jsx)(s.th,{children:"Donn\xe9es d\u2019entra\xeenement"}),(0,t.jsx)(s.th,{children:"Donn\xe9es de test"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"1"}),(0,t.jsx)(s.td,{children:"D3 \u2192 D10"}),(0,t.jsx)(s.td,{children:"D1, D2"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"2"}),(0,t.jsx)(s.td,{children:"D1, D2, D5 \u2192 D10"}),(0,t.jsx)(s.td,{children:"D3, D4"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"3"}),(0,t.jsx)(s.td,{children:"D1 \u2192 D4, D7 \u2192 D10"}),(0,t.jsx)(s.td,{children:"D5, D6"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"4"}),(0,t.jsx)(s.td,{children:"D1 \u2192 D6, D9, D10"}),(0,t.jsx)(s.td,{children:"D7, D8"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"5"}),(0,t.jsx)(s.td,{children:"D1 \u2192 D8"}),(0,t.jsx)(s.td,{children:"D9, D10"})]})]})]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"R\xe9sum\xe9"})}),"\n",(0,t.jsx)(s.p,{children:"Avec K-Fold, tu entra\xeenes K fois et tu testes K fois, mais chaque donn\xe9e n\u2019est test\xe9e qu\u2019une seule fois, et jamais dans le m\xeame fold."})]})}function h(e={}){const{wrapper:s}={...(0,i.M)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},2172:(e,s,n)=>{n.d(s,{I:()=>d,M:()=>l});var t=n(1504);const i={},r=t.createContext(i);function l(e){const s=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function d(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),t.createElement(r.Provider,{value:s},e.children)}}}]);