"use strict";(self.webpackChunkschool_learn=self.webpackChunkschool_learn||[]).push([[5056],{8768:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>i,contentTitle:()=>a,default:()=>u,frontMatter:()=>c,metadata:()=>s,toc:()=>l});var r=o(7624),t=o(2172);const c={sidebar_position:1},a="Code Coverage sur Java avec Sonar",s={id:"general/tuto-01-jacoco-sonar",title:"Code Coverage sur Java avec Sonar",description:"Installer Jacoco",source:"@site/docs/general/tuto-01-jacoco-sonar.md",sourceDirName:"general",slug:"/general/tuto-01-jacoco-sonar",permalink:"/documentation/docs/general/tuto-01-jacoco-sonar",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/general/tuto-01-jacoco-sonar.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Sonar",permalink:"/documentation/docs/general/sonar"},next:{title:"Tutorial Intro",permalink:"/documentation/docs/intro"}},i={},l=[{value:"Installer Jacoco",id:"installer-jacoco",level:2},{value:"Ajouter test jacoco dans test gradle",id:"ajouter-test-jacoco-dans-test-gradle",level:2},{value:"sonar-project.properties",id:"sonar-projectproperties",level:2},{value:"Ex\xe9cuter le code coverage Jacoco en CMD nativement",id:"ex\xe9cuter-le-code-coverage-jacoco-en-cmd-nativement",level:2}];function d(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.M)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"code-coverage-sur-java-avec-sonar",children:"Code Coverage sur Java avec Sonar"}),"\n",(0,r.jsx)(n.h2,{id:"installer-jacoco",children:"Installer Jacoco"}),"\n",(0,r.jsx)(n.p,{children:"Dans votre fichier build.gradle :"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'plugins {\n    ....\n\tid \'jacoco\'\n\tid "org.sonarqube" version "4.3.1.3277"\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"Apr\xe9s plugins il faut sp\xe9cifier la version de jacoco :"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'jacoco {\n\ttoolVersion = "0.8.7"\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"Sp\xe9cifier \xe0 jacoco de g\xe9n\xe9rer le rapport du test coverage en XML et HTML"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"jacocoTestReport {\n\treports {\n\t\txml.required = true\n\t\thtml.outputLocation = layout.buildDirectory.dir('jacocoHtml')\n\t}\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:"Toujours au premier niveau d'indentation (pas d'indentation) il faut remettre les m\xeames param\xe8tres d'authentification Sonar dans le Gradle pour que les t\xe2ches Gradle puissent se connecter au SonarQube"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'sonar {\n\tproperties {\n\t\tproperty "sonar.projectKey", "Demo"\n\t\tproperty "sonar.host.url", "http://localhost:9000"\n\t\tproperty "sonar.token", "sqp_c45c454825fb09a8b904e59e77e182b917cb3d6c"\n\t}\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"ajouter-test-jacoco-dans-test-gradle",children:"Ajouter test jacoco dans test gradle"}),"\n",(0,r.jsx)(n.p,{children:"Dans tasks.named('test'):"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"finalizedBy jacocoTestReport\n"})}),"\n",(0,r.jsx)(n.p,{children:"Donc \xe7a ressemble \xe0 :"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"tasks.named('test') {\n\tuseJUnitPlatform()\n\tfinalizedBy jacocoTestReport\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Cela permet de dire \xe0 ",(0,r.jsx)(n.code,{children:"gradle test"})," d'effectuer les tests suivants :"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Tests unitaires JUnit"}),"\n",(0,r.jsx)(n.li,{children:"Tests jacoco (code coverage)"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"sonar-projectproperties",children:"sonar-project.properties"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"On dit \xe0 Sonar que le code coverage est fait par jacoco"}),"\n",(0,r.jsx)(n.li,{children:"On scan e ncode coverage uniquement les services"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"sonar.java.coveragePlugin=jacoco\nsonar.coverage.jacoco.xmlReportPaths=build/reports/jacoco/jacocoTestReport.xml\nsonar.inclusions=**/*Service.java\n"})}),"\n",(0,r.jsx)(n.h2,{id:"ex\xe9cuter-le-code-coverage-jacoco-en-cmd-nativement",children:"Ex\xe9cuter le code coverage Jacoco en CMD nativement"}),"\n",(0,r.jsx)(n.p,{children:"A ex\xe9cuter \xe0 la racine du projet projet en CMD"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"gradlew.bat build jacocoTestReport sonar\n"})}),"\n",(0,r.jsx)(n.admonition,{title:"Note",type:"info",children:(0,r.jsx)(n.p,{children:"Je conseil d'utiliser la ligne de commande native"})})]})}function u(e={}){const{wrapper:n}={...(0,t.M)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},2172:(e,n,o)=>{o.d(n,{I:()=>s,M:()=>a});var r=o(1504);const t={},c=r.createContext(t);function a(e){const n=r.useContext(c);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),r.createElement(c.Provider,{value:n},e.children)}}}]);